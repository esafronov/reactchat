{"version":3,"sources":["config.js","Chat.js","Login.js","App.js","index.js"],"names":["config","server","Chat","props","_this","Object","classCallCheck","this","moment","locale","possibleConstructorReturn","getPrototypeOf","call","state","username","message","messages","timestamp","isPrevious","init","socket","io","on","now","Date","getTime","setState","sendPrevious","data","addPrevious","action","emit","length","reverse","concat","toConsumableArray","scrolldown","addMessage","sendMessage","ev","preventDefault","author","formatTime","time","format","el","document","getElementsByClassName","scrollHeight","Math","max","clientHeight","scrollTop","_this2","react_default","a","createElement","className","type","onClick","map","index","key","created","value","onChange","target","placeholder","required","React","Component","Login","auth","login","App","logged","bind","assertThisInitialized","console","log","screen","src_Chat","src_Login","ReactDOM","render","src_App","getElementById"],"mappings":"qSAAaA,SAAU,CACtBC,OAAQ,mBCoKMC,cA9JV,SAAAA,EAAYC,GAAM,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,GAKrBM,IAAOC,OAAO,OAEdL,EAAAC,OAAAK,EAAA,EAAAL,CAAAE,KAAAF,OAAAM,EAAA,EAAAN,CAAAH,GAAAU,KAAAL,KAAMJ,KAKDU,MAAQ,CACHC,SAAUX,EAAMW,SAChBC,QAAS,GACTC,SAAU,GACnBC,UAAY,KACZC,YAAa,EACbC,MAAO,GAMRf,EAAKgB,OAASC,IAAGrB,EAAOC,QAExBG,EAAKgB,OAAOE,GAAG,UAAW,WACzB,IAAIC,GAAM,IAAIC,MAAOC,UAErBrB,EAAKsB,SAAS,CACbT,UAAYM,IAGRnB,EAAKS,MAAMM,MAAMf,EAAKuB,aAAa,UAMzCvB,EAAKgB,OAAOE,GAAG,eAAgB,SAAAM,GAE9BxB,EAAKyB,YAAYD,KAMlBxB,EAAKuB,aAAe,SAACG,GACpB1B,EAAKgB,OAAOW,KAAK,gBAAiB,CACjCd,UAAYb,EAAKS,MAAMI,UACvBa,OAASA,KAOX1B,EAAKyB,YAAc,SAAAD,GAEfA,EAAKZ,SAASgB,OAAO,KACvB5B,EAAKsB,SAAS,CACbR,YAAa,IAEa,IAAvBU,EAAKZ,SAASgB,UAEnBJ,EAAKZ,SAASiB,UAEd7B,EAAKsB,SAAS,CACbT,UAAYW,EAAKZ,SAASgB,OAAS,EAAIJ,EAAKZ,SAAS,GAAGC,UAAYb,EAAKS,MAAMI,UAC/ED,SAAQ,GAAAkB,OAAA7B,OAAA8B,EAAA,EAAA9B,CAAOuB,EAAKZ,UAAZX,OAAA8B,EAAA,EAAA9B,CAAwBD,EAAKS,MAAMG,aAG1B,SAAdY,EAAKE,SACR1B,EAAKsB,SAAS,CACbP,MAAO,IAERf,EAAKgC,gBAOPhC,EAAKgB,OAAOE,GAAG,cAAe,SAAAM,GAC7BxB,EAAKiC,WAAWT,KAMjBxB,EAAKiC,WAAa,SAAAT,GACjBxB,EAAKsB,SAAS,CAACV,SAAQ,GAAAkB,OAAA7B,OAAA8B,EAAA,EAAA9B,CAAOD,EAAKS,MAAMG,UAAlB,CAA2BY,MAClDxB,EAAKgC,cAMNhC,EAAKkC,YAAc,SAAAC,GAClB,IAAKnC,EAAKS,MAAME,QAAS,OAAO,EAChCwB,EAAGC,iBACHpC,EAAKgB,OAAOW,KAAK,eAAgB,CAChCU,OAAQrC,EAAKS,MAAMC,SACnBC,QAASX,EAAKS,MAAME,UAErBX,EAAKsB,SAAS,CAACX,QAAS,MAMzBX,EAAKsC,WAAa,SAAAC,GACjB,OAAOnC,IAAOmC,GAAMC,OAAO,mBAM5BxC,EAAKgC,WAAa,WACjB,IAAIS,EAAKC,SAASC,uBAAuB,cACrCC,EAAeC,KAAKC,IAAIL,EAAG,GAAGG,aAAcH,EAAG,GAAGM,cACtDN,EAAG,GAAGO,UAAYJ,EAAeH,EAAG,GAAGM,cAzHnB/C,wEA6Hd,IAAAiD,EAAA9C,KACP,OACU+C,EAAAC,EAAAC,cAAA,YACRF,EAAAC,EAAAC,cAAA,kBACAF,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,cACfH,EAAAC,EAAAC,cAAA,MAAIC,UAAU,cACZlD,KAAKM,MAAMK,YACXoC,EAAAC,EAAAC,cAAA,MAAIC,UAAU,mBACbH,EAAAC,EAAAC,cAAA,UAAQC,UAAU,kBAAkBC,KAAK,SAASC,QAAS,SAAApB,GAAOc,EAAK1B,iBAAvE,kBAGDpB,KAAKM,MAAMG,SAAS4C,IAAI,SAAC7C,EAAQ8C,GACjC,OACCP,EAAAC,EAAAC,cAAA,MAAIC,UAAU,kBAAkBK,IAAKD,GACrCP,EAAAC,EAAAC,cAAA,aAAQH,EAAKX,WAAW3B,EAAQgD,SAAhC,IAA0CT,EAAAC,EAAAC,cAAA,SAAIzC,EAAQ0B,SAAmBa,EAAAC,EAAAC,cAAA,WACzEF,EAAAC,EAAAC,cAAA,SAAIzC,EAAQA,cAKfuC,EAAAC,EAAAC,cAAA,UACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,SAAOQ,MAAOzD,KAAKM,MAAME,QAASkD,SAAU,SAAA1B,GAAE,OAAIc,EAAK3B,SAAS,CAACX,QAAUwB,EAAG2B,OAAOF,SAASN,KAAK,OAAOS,YAAY,UAAUC,UAAQ,EAACX,UAAU,iBACnJH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBACfH,EAAAC,EAAAC,cAAA,UAAQG,QAASpD,KAAK+B,YAAcoB,KAAK,SAASD,UAAU,gCAA5D,kBAvJaY,IAAMC,WC8BVC,cAjCV,SAAAA,EAAYpE,GAAM,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAgE,IACfnE,EAAAC,OAAAK,EAAA,EAAAL,CAAAE,KAAAF,OAAAM,EAAA,EAAAN,CAAAkE,GAAA3D,KAAAL,KAAMJ,KAEPU,MAAQ,CACZC,SAAU,MAGXV,EAAKoE,KAAO,SAAAjC,GACX,IAAKnC,EAAKS,MAAMC,SAAU,OAAO,EACjCyB,EAAGC,iBAEHpC,EAAKD,MAAMsE,MAAMrE,EAAKS,MAAMC,WAXRV,wEAgBd,IAAAiD,EAAA9C,KAEP,OACQ+C,EAAAC,EAAAC,cAAA,YACPF,EAAAC,EAAAC,cAAA,mBACAF,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,SAAOY,UAAQ,EAACH,SAAU,SAAA1B,GAAE,OAAIc,EAAK3B,SAAS,CAACZ,SAAWyB,EAAG2B,OAAOF,SAASN,KAAK,OAAOD,UAAU,eAAgBU,YAAY,0BAC/Hb,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBAChBH,EAAAC,EAAAC,cAAA,UAAQG,QAASpD,KAAKiE,KAAOd,KAAK,SAASD,UAAU,mBAArD,mBA1BgBY,IAAMC,WC8CXI,cA3Cd,SAAAA,EAAYvE,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAmE,IAClBtE,EAAAC,OAAAK,EAAA,EAAAL,CAAAE,KAAAF,OAAAM,EAAA,EAAAN,CAAAqE,GAAA9D,KAAAL,KAAMJ,KACDU,MAAQ,CACZ8D,QAAS,EACT7D,SAAU,MAGXV,EAAKqE,MAAQrE,EAAKqE,MAAMG,KAAXvE,OAAAwE,EAAA,EAAAxE,QAAAwE,EAAA,EAAAxE,CAAAD,KAPKA,qEAWbU,GACLgE,QAAQC,IAAIjE,GACZP,KAAKmB,SAAS,CACbiD,QAAQ,EACR7D,SAAUA,qCAKZ,IAAIkE,EAAS,GAKb,OAHCA,EADGzE,KAAKM,MAAM8D,OACLrB,EAAAC,EAAAC,cAACyB,EAAD,CAAMnE,SAAUP,KAAKM,MAAMC,WAE3BwC,EAAAC,EAAAC,cAAC0B,EAAD,CAAOT,MAAOlE,KAAKkE,QAE3BnB,EAAAC,EAAAC,cAAA,WACCF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,aACdH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACdH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SAChBH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,QACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,aACfuB,eAjCWV,yBCClBa,IAASC,OAAO9B,EAAAC,EAAAC,cAAC6B,EAAD,MAASvC,SAASwC,eAAe","file":"static/js/main.39a3b945.chunk.js","sourcesContent":["export const config =  {\r\n\tserver: 'localhost:8080'\r\n}","import React from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport moment from 'moment/moment.js';\r\nimport 'moment/locale/ru';\r\nimport { config } from './config.js';\r\n\r\nclass Chat extends React.Component{\r\n     constructor(props){\r\n        \r\n\t\t/*\r\n\t\tset moment localization\r\n\t\t*/\r\n\t\tmoment.locale('ru');\r\n\t\t\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t/*\r\n\t\tdefault react data\r\n\t\t*/\r\n\t\tthis.state = {\r\n            username: props.username,\r\n            message: '',\r\n            messages: [],\r\n\t\t\ttimestamp : null,\r\n\t\t\tisPrevious : true, //show or hide previous button\r\n\t\t\tinit : false //is chat initialized\r\n        };\r\n\t\t\r\n\t\t/*\r\n\t\tconnect to chat server\r\n\t\t*/\r\n\t\tthis.socket = io(config.server);\r\n\t\t\r\n\t\tthis.socket.on('connect', () => {\r\n\t\t\tlet now = new Date().getTime();\r\n\t\t\t//set current timestamp\r\n\t\t\tthis.setState({\r\n\t\t\t\ttimestamp : now\r\n\t\t\t});\r\n\t\t\t//request previous messages on init\r\n\t\t\tif (!this.state.init) this.sendPrevious('init');\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\tincoming socket event from server\r\n\t\t*/\r\n\t\tthis.socket.on('get_previous', data => {\r\n\t\t\t//add requested messages\r\n\t\t\tthis.addPrevious(data);\r\n\t\t});\r\n\t\t\r\n\t\t/*\r\n\t\trequest previous messages from server\r\n\t\t*/\r\n\t\tthis.sendPrevious = (action) => {\r\n\t\t\tthis.socket.emit('send_previous', {\t\r\n\t\t\t\ttimestamp : this.state.timestamp,\r\n\t\t\t\taction : action\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tadd incoming messages to react state\r\n\t\t*/\r\n\t\tthis.addPrevious = data => {\r\n\t\t\t//show or hide load previous button depend on incoming messages count\r\n\t\t\tif(data.messages.length<10) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tisPrevious : false\r\n\t\t\t\t});\r\n\t\t\t\tif (data.messages.length===0) return;\r\n\t\t\t}\r\n\t\t\tdata.messages.reverse();\r\n\t\t\t//change chat window timestamp\r\n\t\t\tthis.setState({\r\n\t\t\t\ttimestamp : data.messages.length > 0 ? data.messages[0].timestamp : this.state.timestamp, \r\n\t\t\t\tmessages : [...data.messages,...this.state.messages]\r\n\t\t\t});\r\n\t\t\t//call scroll down chat only on chat initialization\r\n\t\t\tif (data.action==='init') {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tinit : true\r\n\t\t\t\t});\r\n\t\t\t\tthis.scrolldown();\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t\t\r\n\t\t/*\r\n\t\tincoming socket event from server\r\n\t\t*/\r\n\t\tthis.socket.on('get_message', data => {\r\n\t\t\tthis.addMessage(data);\r\n\t\t});\r\n\t\t\r\n\t\t/*\r\n\t\tadd incoming message to react state\r\n\t\t*/\r\n\t\tthis.addMessage = data => {\r\n\t\t\tthis.setState({messages : [...this.state.messages,data]});\r\n\t\t\tthis.scrolldown();\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tsend message to chat server for broadcasting\r\n\t\t*/\r\n\t\tthis.sendMessage = ev => {\r\n\t\t\tif (!this.state.message) return false;\r\n\t\t\tev.preventDefault();\r\n\t\t\tthis.socket.emit('send_message', {\r\n\t\t\t\tauthor: this.state.username,\r\n\t\t\t\tmessage: this.state.message\r\n\t\t\t});\r\n\t\t\tthis.setState({message: ''});\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tformat message time with moment\r\n\t\t*/\r\n\t\tthis.formatTime = time => {\r\n\t\t\treturn moment(time).format('D MMM HH:mm:ss')\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\tscroll down chat\r\n\t\t*/\r\n\t\tthis.scrolldown = () => {\t\t\t\r\n\t\t\tlet el = document.getElementsByClassName('scrollable');\r\n\t\t\tlet scrollHeight = Math.max(el[0].scrollHeight, el[0].clientHeight);\r\n\t\t\tel[0].scrollTop = scrollHeight - el[0].clientHeight;\r\n\t\t}\r\n\t}\r\n\t\r\n\trender(){\r\n\t\treturn (\r\n            <form>\r\n\t\t\t\t<h3>Chat</h3>\r\n\t\t\t\t<hr/>\r\n\t\t\t\t<div className=\"scrollable\">\r\n\t\t\t\t<ul className=\"list-group\">\r\n\t\t\t\t\t{this.state.isPrevious &&\r\n\t\t\t\t\t\t<li className=\"list-group-item\">\r\n\t\t\t\t\t\t\t<button className=\"btn btn-primary\" type=\"button\" onClick={ev => {this.sendPrevious()}}>Load previous</button>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{this.state.messages.map((message,index) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<li className=\"list-group-item\" key={index}>\r\n\t\t\t\t\t\t\t<small>{this.formatTime(message.created)} <b>{message.author}</b></small><br/> \r\n\t\t\t\t\t\t\t<i>{message.message}</i></li>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p></p>\r\n\t\t\t\t<div className=\"input-group\">\r\n\t\t\t\t  <input value={this.state.message} onChange={ev => this.setState({message : ev.target.value})} type=\"text\" placeholder=\"Message\" required className=\"form-control\"/>\r\n\t\t\t\t  <div className=\"input-group-append\">\r\n\t\t\t\t  <button onClick={this.sendMessage}  type=\"submit\" className=\"btn btn-primary form-control\">Send</button>\t\t\t\t\t\r\n\t\t\t\t  </div>\r\n\t\t\t\t</div>\r\n\t\t\t</form>  \r\n        );\r\n    }\r\n}\r\n\r\nexport default Chat;","import React from \"react\";\r\n\r\nclass Login extends React.Component{\r\n     constructor(props){\r\n        super(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tusername: null\r\n\t\t};\r\n\r\n\t\tthis.auth = ev => {\r\n\t\t\tif (!this.state.username) return false;\r\n\t\t\tev.preventDefault();\r\n\t\t\t//call login method of parent component\r\n\t\t\tthis.props.login(this.state.username);\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\trender(){\r\n        \r\n\t\treturn (\r\n          <form>\r\n\t\t\t<h3>Login</h3>\r\n\t\t\t<hr/>\r\n\t\t\t<div className=\"input-group\">\r\n\t\t\t  <input required onChange={ev => this.setState({username : ev.target.value})} type=\"text\" className=\"form-control\"  placeholder=\"Plase enter your name\"/>\r\n\t\t\t  <div className=\"input-group-append\">\r\n\t\t\t\t<button onClick={this.auth}  type=\"submit\" className=\"btn btn-primary\">Login</button>\r\n\t\t\t  </div>\r\n\t\t\t</div>\r\n          </form>           \r\n        );\r\n    }\r\n}\r\n\r\nexport default Login;","import React, { Component } from 'react';\nimport Chat from './Chat';\nimport Login from './Login';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tlogged : false,\n\t\t\tusername: null\n\t\t};\n\t\t// Bind the this context to the handler function\n\t\tthis.login = this.login.bind(this);\n\t}\n  \n\t//login user to chat with his name\n\tlogin(username){\n\t\tconsole.log(username);\n\t\tthis.setState({\n\t\t\tlogged: true, \n\t\t\tusername: username\n\t\t});\n\t}\n  \n\trender() {\n\tlet screen = '';\n\tif (this.state.logged)\n\t\tscreen = <Chat username={this.state.username}/>\n\telse\n\t\tscreen = <Login login={this.login}/>\n\treturn (\n\t  <div>\n\t\t  <div className=\"container\">\n\t\t\t  <div className=\"row\">\n\t\t\t\t  <div className=\"col-4\">\n\t\t\t\t\t<div className=\"card\">\n\t\t\t\t\t  <div className=\"card-body\">\n\t\t\t\t\t\t{screen}\n\t\t\t\t\t  </div>\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t  </div>\n\t  </div>\n\t);\n\t}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './app.css';\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}