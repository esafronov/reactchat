{"version":3,"sources":["Chat.js","Login.js","App.js","index.js"],"names":["Chat","props","_this","Object","classCallCheck","this","moment","locale","possibleConstructorReturn","getPrototypeOf","call","state","username","message","messages","timestamp","isPrevious","socket","io","on","now","Date","getTime","setState","sendPrevious","data","addPrevious","action","console","log","emit","length","reverse","concat","toConsumableArray","scrolldown","addMessage","sendMessage","ev","preventDefault","author","formatTime","time","format","el","document","getElementsByClassName","scrollHeight","Math","max","clientHeight","scrollTop","_this2","react_default","a","createElement","className","type","onClick","map","index","key","created","value","onChange","target","placeholder","required","React","Component","Login","auth","login","App","logged","bind","assertThisInitialized","screen","src_Chat","src_Login","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.1bc88255.chunk.js","sourcesContent":["import React from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport moment from 'moment/moment.js';\r\n\r\nclass Chat extends React.Component{\r\n     constructor(props){\r\n        moment.locale('ru');\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n            username: props.username,\r\n            message: '',\r\n            messages: [],\r\n\t\t\ttimestamp : null,\r\n\t\t\tisPrevious : true\r\n        };\r\n\t\t\r\n\t\tthis.socket = io('localhost:8080');\r\n\t\t\r\n\t\tthis.socket.on('connect', () => {\r\n\t\t\tlet now = new Date().getTime();\r\n\t\t\tthis.setState({timestamp : now});\r\n\t\t\tthis.sendPrevious('init');\r\n\t\t});\r\n\r\n\t\tthis.socket.on('get_previous', data => {\r\n\t\t\tthis.addPrevious(data);\r\n\t\t});\r\n\t\t\r\n\t\tthis.sendPrevious = (action) => {\r\n\t\t\tconsole.log(action);\r\n\t\t\tthis.socket.emit('send_previous', {\t\r\n\t\t\t\ttimestamp : this.state.timestamp,\r\n\t\t\t\taction : action\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tthis.addPrevious = data => {\r\n\t\t\tif(data.messages.length<10) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tisPrevious : false\r\n\t\t\t\t});\r\n\t\t\t\tif (data.messages.length===0) return;\r\n\t\t\t}\r\n\t\t\tdata.messages.reverse();\r\n\t\t\tthis.setState({\r\n\t\t\t\ttimestamp : data.messages.length > 0 ? data.messages[0].timestamp : this.state.timestamp, \r\n\t\t\t\tmessages : [...data.messages,...this.state.messages]\r\n\t\t\t});\r\n\t\t\tif (data.action==='init') this.scrolldown();\r\n\t\t}\t\t\r\n\t\t\r\n\t\tthis.socket.on('get_message', data => {\r\n\t\t\tthis.addMessage(data);\r\n\t\t});\r\n\t\t\r\n\t\tthis.addMessage = data => {\r\n\t\t\tthis.setState({messages : [...this.state.messages,data]});\r\n\t\t\tthis.scrolldown();\r\n\t\t}\r\n\t\t\r\n\t\tthis.sendMessage = ev => {\r\n\t\t\tif (!this.state.message) return false;\r\n\t\t\tev.preventDefault();\r\n\t\t\tthis.socket.emit('send_message', {\r\n\t\t\t\tauthor: this.state.username,\r\n\t\t\t\tmessage: this.state.message\r\n\t\t\t});\r\n\t\t\tthis.setState({message: ''});\r\n\t\t}\r\n\t\t\r\n\t\tthis.formatTime = time => {\r\n\t\t\treturn moment(time).format('HH:mm:ss')\r\n\t\t}\r\n\t\t\r\n\t\tthis.scrolldown = () => {\t\t\t\r\n\t\t\tlet el = document.getElementsByClassName('scrollable');\r\n\t\t\tlet scrollHeight = Math.max(el[0].scrollHeight, el[0].clientHeight);\r\n\t\t\tel[0].scrollTop = scrollHeight - el[0].clientHeight;\r\n\t\t}\r\n\t}\r\n\t\r\n\trender(){\r\n\t\treturn (\r\n            <form>\r\n\t\t\t\t<h3>Chat</h3>\r\n\t\t\t\t<hr/>\r\n\t\t\t\t<div className=\"scrollable\">\r\n\t\t\t\t<ul className=\"list-group\">\r\n\t\t\t\t\t{this.state.isPrevious &&\r\n\t\t\t\t\t\t<li className=\"list-group-item\">\r\n\t\t\t\t\t\t\t<button className=\"btn btn-primary\" type=\"button\" onClick={ev => {this.sendPrevious()}}>Load previous</button>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{this.state.messages.map((message,index) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<li className=\"list-group-item\" key={index}>{this.formatTime(message.created)} <b>{message.author}</b><br/> {message.message}</li>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p></p>\r\n\t\t\t\t<div className=\"input-group\">\r\n\t\t\t\t  <input value={this.state.message} onChange={ev => this.setState({message : ev.target.value})} type=\"text\" placeholder=\"Message\" required className=\"form-control\"/>\r\n\t\t\t\t  <div className=\"input-group-append\">\r\n\t\t\t\t  <button onClick={this.sendMessage}  type=\"submit\" className=\"btn btn-primary form-control\">Send</button>\t\t\t\t\t\r\n\t\t\t\t  </div>\r\n\t\t\t\t</div>\r\n\t\t\t</form>  \r\n        );\r\n    }\r\n}\r\n\r\nexport default Chat;","import React from \"react\";\r\n\r\nclass Login extends React.Component{\r\n     constructor(props){\r\n        super(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tusername: null\r\n\t\t};\r\n\r\n\t\tthis.auth = ev => {\r\n\t\t\tif (!this.state.username) return false;\r\n\t\t\tev.preventDefault();\r\n\t\t\tthis.props.login(this.state.username);\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\trender(){\r\n        \r\n\t\treturn (\r\n          <form>\r\n\t\t\t<h3>Login</h3>\r\n\t\t\t<hr/>\r\n\t\t\t<div className=\"input-group\">\r\n\t\t\t  <input required onChange={ev => this.setState({username : ev.target.value})} type=\"text\" className=\"form-control\"  placeholder=\"Plase enter your name\"/>\r\n\t\t\t  <div className=\"input-group-append\">\r\n\t\t\t\t<button onClick={this.auth}  type=\"submit\" className=\"btn btn-primary\">Login</button>\r\n\t\t\t  </div>\r\n\t\t\t</div>\r\n          </form>           \r\n        );\r\n    }\r\n}\r\n\r\nexport default Login;","import React, { Component } from 'react';\nimport Chat from './Chat';\nimport Login from './Login';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tlogged : false,\n\t\t\tusername: null\n\t\t};\n\t\t// Bind the this context to the handler function\n\t\tthis.login = this.login.bind(this);\n\t}\n  \n\tlogin(username){\n\t\tconsole.log(username);\n\t\tthis.setState({\n\t\t\tlogged: true, \n\t\t\tusername: username\n\t\t});\n\t}\n  \n\trender() {\n\tlet screen = '';\n\tif (this.state.logged)\n\t\tscreen = <Chat username={this.state.username}/>\n\telse\n\t\tscreen = <Login login={this.login}/>\n\treturn (\n\t  <div>\n\t\t  <div className=\"container\">\n\t\t\t  <div className=\"row\">\n\t\t\t\t  <div className=\"col-4\">\n\t\t\t\t\t<div className=\"card\">\n\t\t\t\t\t  <div className=\"card-body\">\n\t\t\t\t\t\t{screen}\n\t\t\t\t\t  </div>\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t  </div>\n\t\t  </div>\n\t  </div>\n\t);\n\t}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './app.css';\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}